@echo off

setlocal ENABLEDELAYEDEXPANSION
set "vDir=%~1"
set "command=DQAKACAAIAAgACAAcABhAHIAYQBtACgADQAKAA0ACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAE0AYQBuAGQAYQB0AG8AcgB5ACkAXQANAAoAIAAgACAAIAAgACAAIAAgAFsAcwB0AHIAaQBuAGcAXQAgACMAcwBpAG4AZwBsAGUAIABzAHQAcgBpAG4AZwAgAGEAbgBkACAAbgBvAHQAIABhACAAYQByAHIAYQB5ACEADQAKACAAIAAgACAAIAAgACAAIAAkAHQAYQByAGcAZQB0AA0ACgAgACAAIAAgACkADQAKACAAIAAgACAAJAB0AGEAcgBnAGUAdAANAAoAIAAgACAAIAAjACAARwBlAHQAIAB0AGgAZQAgAGMAdQByAHIAZQBuAHQAIABFAHgAZQBjAHUAdABpAG8AbgAgAFQAaQBtAGUACgAgACAAIAAgACQATABvAGcAUwB0AGEAbQBwACAAPQAgAEcAZQB0AC0ARABhAHQAZQAgAC0ARgBvAHIAbQBhAHQAIAAnAHkAeQB5AHkALQBNAE0ALQBkAGQAXwBIAEgAXwBtAG0AJwANAAoAIAAgACAAIAAkAGUAeABlAGMAdQB0AGkAbwBuAFAAYQB0AGgAIAA9ACAAKABSAGUAcwBvAGwAdgBlAC0AUABhAHQAaAAgAC4AXAApAC4AUABhAHQAaAANAAoAIAAgACAAIAAkAGwAbwBnAEYAaQBsAGUAIAA9ACAAIgAuAFwAUwBjAHIAaQBwAHQAXwAkAEwAbwBnAFMAdABhAG0AcAAuAGwAbwBnACAAIgANAAoADQAKACAAIAAgACAAUwB0AGEAcgB0AC0AVAByAGEAbgBzAGMAcgBpAHAAdAAgAC0AUABhAHQAaAAgACQAbABvAGcARgBpAGwAZQAgACAALQBBAHAAcABlAG4AZAANAAoADQAKACAAIAAgACAAIwB1AHMAZQBkACAAZgBvAHIAIABkAGUAYgB1AGcAaQBuAGcADQAKACAAIAAgACAAIwBTAGUAdAAtAEwAbwBjAGEAdABpAG8AbgAgAC0AUABhAHQAaAAgAEQAOgBcADAAMgBEAGUAdgBlAGwAbwBwAG0AZQBuAHQAXAAwADEAUwBvAHUAcgBjAGUAXAAwADIALQBNAGkAYwByAG8AcwBvAGYAdABcAEMAbwBuAHQAZQB4AHQALQBNAGUAbgB1AFwATQB5AFQAbwBvAGwAcwBcAEIAYQBzAGUATQBlAG4AdQBcAA0ACgAgACAAIAAgACMAUwBlAHQALQBMAG8AYwBhAHQAaQBvAG4AIAAtAFAAYQB0AGgAIAAiACQAZQBuAHYAOgBVAFMARQBSAFAAUgBPAEYASQBMAEUAXABPAG4AZQBEAHIAaQB2AGUAIAAtACAASgBvAG4AIABTAHQAZQBuAGIAZQByAGcAIABBAEIAXAAwADIARABlAHYAZQBsAG8AcABtAGUAbgB0AFwAMAAxAFMAbwB1AHIAYwBlAFwAMAAyAC0AbQBpAGMAcgBvAHMAbwBmAHQAXABXAGkAbgBkAG8AdwBzAC0ARgB1AG4AYwB0AGkAbwBuAHMAXABDAG8AbgB0AGUAeAB0AC0ATQBlAG4AdQAtAEMAbwBtAG0AYQBuAGQAcwBcAE0AeQBUAG8AbwBsAHMAXABCAGEAcwBlAE0AZQBuAHUAIgANAAoAIAAgACAAIAAjACQAdABhAHIAZwBlAHQAPQAiAC4AXABOAGUAdwAgAGYAbwBsAGQAZQByACIADQAKAA0ACgANAAoADQAKACAAIAAgACAAJAB0AGEAcgBnAGUAdAAgAD0AIAAkAHQAYQByAGcAZQB0AC4AVAByAGkAbQAoACcAXAAiACcAKQANAAoAIAAgACAAIAAkAG4AYQBtAGUAIAA9ACAAUwBwAGwAaQB0AC0AUABhAHQAaAAgACQAdABhAHIAZwBlAHQAIAAtAEwAZQBhAGYADQAKACAAIAAgACAAJABwAGEAcgBlAG4AdABkAGkAcgAgAD0AIABTAHAAbABpAHQALQBQAGEAdABoACAAJAB0AGEAcgBnAGUAdAAgAC0AUABhAHIAZQBuAHQAIAAtAFIAZQBzAG8AbAB2AGUADQAKACAAIAAgACAAJABmAHUAbABsACAAPQAgAFIAZQBzAG8AbAB2AGUALQBQAGEAdABoACAAJAB0AGEAcgBnAGUAdAANAAoADQAKACAAIAAgACAAJABsAGkAbgBrAE4AYQBtAGUAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEkATwAuAFAAYQB0AGgAXQA6ADoARwBlAHQARgBpAGwAZQBOAGEAbQBlAFcAaQB0AGgAbwB1AHQARQB4AHQAZQBuAHMAaQBvAG4AKAAkAGYAdQBsAGwAKQAgACsAIAAiAF8AbABpAG4AawAiACAAKwAgAFsAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGEAdABoAF0AOgA6AEcAZQB0AEUAeAB0AGUAbgBzAGkAbwBuACgAJABmAHUAbABsACkADQAKAA0ACgAgACAAIAAgACQAbABpAG4AawBQAGEAdABoACAAPQAgAEoAbwBpAG4ALQBQAGEAdABoACAAJABwAGEAcgBlAG4AdABkAGkAcgAgACQAbABpAG4AawBOAGEAbQBlAA0ACgANAAoAIAAgACAAIABXAHIAaQB0AGUALQBPAHUAdABwAHUAdAAgACAAIgB0AGEAcgBnAGUAdAAgACAAIAAgACAAPQAgACQAdABhAHIAZwBlAHQAIgANAAoAIAAgACAAIABXAHIAaQB0AGUALQBPAHUAdABwAHUAdAAgACAAIgBuAGEAbQBlACAAIAAgACAAIAAgACAAPQAgACQAbgBhAG0AZQAiAA0ACgAgACAAIAAgAFcAcgBpAHQAZQAtAE8AdQB0AHAAdQB0ACAAIAAiAGYAdQBsAGwAIABwAGEAdABoACAAIAA9ACAAJABmAHUAbABsACIADQAKACAAIAAgACAAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAgACIAcABhAHIAZQBuAHQAIABkAGkAcgAgAD0AIAAkAHAAYQByAGUAbgB0AGQAaQByACIADQAKAA0ACgAgACAAIAAgAFcAcgBpAHQAZQAtAE8AdQB0AHAAdQB0ACAAIAAiAGwAaQBuAGsATgBhAG0AZQByACAAPQAgACQAbABpAG4AawBOAGEAbQBlACIADQAKACAAIAAgACAAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAgACIAbABpAG4AawBQAGEAdABoACAAPQAgACQAbABpAG4AawBQAGEAdABoACIADQAKAA0ACgAgACAAIAAgAE4AZQB3AC0ASQB0AGUAbQAgAC0ASQB0AGUAbQBUAHkAcABlACAAUwB5AG0AYgBvAGwAaQBjAEwAaQBuAGsAIAAtAFAAYQB0AGgAIAAkAGwAaQBuAGsAUABhAHQAaAAgAC0AVABhAHIAZwBlAHQAIAAkAGYAdQBsAGwADQAKAA0ACgAgACAAIAAgAFMAdABvAHAALQBUAHIAYQBuAHMAYwByAGkAcAB0AA0ACgANAAoAIAAgACAAIABwAGEAdQBzAGUADQAKAA=="

echo "aa: %1"


echo %~1 | powershell.exe -NoExit -EncodedCommand %command% 

echo "Test" | powershell.exe -NoExit -EncodedCommand %command% 
$input1 | powershell.exe -NoExit -EncodedCommand %command% 

Start-Process powershell -ArgumentList '-NoExit -EncodedCommand %command% ' -RunAS

PowerShell.exe -Command 'Start-Process powershell -ArgumentList '-NoExit -EncodedCommand %command% ' -RunAS'

echo %~1 | powershell.exe -NoProfile -Command "Start-Process powershell -ArgumentList '-NoExit -EncodedCommand %encoded%' -Verb RunAs"
echo %~1 | powershell.exe -NoProfile -Command "Start-Process powershell -ArgumentList '-NoExit Write-Output("$")' -Verb RunAs"


 set "PIPE_INPUT=asasasasdsda" | echo %PIPE_INPUT%
 set "PIPE_INPUT=T111" & powershell -Command "Start-Process powershell -Verb RunAs -ArgumentList '-NoExit -Command \"$input = \\\"%PIPE_INPUT%\\\";$cdir = \\\"%CD%\\\"; Write-Output("$input , $cdir")\" ' "
 
 
 reg command

cmd.exe /v /c  set "PIPE=%1" & powershell -Command "Start-Process powershell -Verb RunAs -ArgumentList '-NoExit -Command \" $input1 = \\\"!PIPE!\\\" ;$cdir1 = \\\"!CD!\\\"; cd $cdir1; powershell -NoExit Write-Output("$cdir1") ;   pause      \" ' "


cmd.exe /v /c  set "PIPE=%1" & powershell -Command "Start-Process powershell -Verb RunAs -ArgumentList '-NoExit -Command \" $input1 = \\\"!PIPE!\\\" ;$cdir1 = \\\"!CD!\\\"; cd $cdir1; powershell -NoExit Write-Output("$cdir1"+\\"\"    ssss\\"\") ;   pause      \" ' " & pause


cmd.exe /v /c  set "PIPE=%1" & powershell -Command "Start-Process powershell -Verb RunAs -ArgumentList '-NoExit -Command \" $input1 = \\"!PIPE!\\" ;$cdir1 = \\"!CD!\\"; cd $cdir1; $command1=\\"AAA\\" ; Write-Output($cdir1) ; pause     \" '" & pause

cmd.exe /v /c  powershell -Command "Start-Process cmd -Verb RunAs -ArgumentList '/v /k  echo "%1" | powershell.exe -NoExit Write-Output(@($input))          &pause'" & pause

cmd.exe /v /c  powershell -Command "Start-Process cmd -Verb RunAs -ArgumentList '/v /k  echo "%1" | powershell.exe -NoExit  -EncodedCommand DQAKACAAIAAgACAAcABhAHIAYQBtACgADQAKAA0ACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAE0AYQBuAGQAYQB0AG8AcgB5ACkAXQANAAoAIAAgACAAIAAgACAAIAAgAFsAcwB0AHIAaQBuAGcAXQAgACMAcwBpAG4AZwBsAGUAIABzAHQAcgBpAG4AZwAgAGEAbgBkACAAbgBvAHQAIABhACAAYQByAHIAYQB5ACEADQAKACAAIAAgACAAIAAgACAAIAAkAHQAYQByAGcAZQB0AA0ACgAgACAAIAAgACkADQAKACAAIAAgACAADQAKACAAIAAgACAADQAKACAAIAAgACAAIwAgAEcAZQB0ACAAdABoAGUAIABjAHUAcgByAGUAbgB0ACAARQB4AGUAYwB1AHQAaQBvAG4AIABUAGkAbQBlAAoAIAAgACAAIAAkAEwAbwBnAFMAdABhAG0AcAAgAD0AIABHAGUAdAAtAEQAYQB0AGUAIAAtAEYAbwByAG0AYQB0ACAAJwB5AHkAeQB5AC0ATQBNAC0AZABkAF8ASABIAF8AbQBtACcADQAKACAAIAAgACAAJABlAHgAZQBjAHUAdABpAG8AbgBQAGEAdABoACAAPQAgACgAUgBlAHMAbwBsAHYAZQAtAFAAYQB0AGgAIAAuAFwAKQAuAFAAYQB0AGgADQAKACAAIAAgACAAJABsAG8AZwBGAGkAbABlACAAPQAgACIAJAB0AGEAcgBnAGUAdABcAC4ALgBcAFMAYwByAGkAcAB0AF8AJABMAG8AZwBTAHQAYQBtAHAALgBsAG8AZwAgACIADQAKAA0ACgAgACAAIAAgAFMAdABhAHIAdAAtAFQAcgBhAG4AcwBjAHIAaQBwAHQAIAAtAFAAYQB0AGgAIAAkAGwAbwBnAEYAaQBsAGUAIAAgAC0AQQBwAHAAZQBuAGQADQAKAA0ACgAgACAAIAAgACMAdQBzAGUAZAAgAGYAbwByACAAZABlAGIAdQBnAGkAbgBnAA0ACgAgACAAIAAgACMAUwBlAHQALQBMAG8AYwBhAHQAaQBvAG4AIAAtAFAAYQB0AGgAIABEADoAXAAwADIARABlAHYAZQBsAG8AcABtAGUAbgB0AFwAMAAxAFMAbwB1AHIAYwBlAFwAMAAyAC0ATQBpAGMAcgBvAHMAbwBmAHQAXABDAG8AbgB0AGUAeAB0AC0ATQBlAG4AdQBcAE0AeQBUAG8AbwBsAHMAXABCAGEAcwBlAE0AZQBuAHUAXAANAAoAIAAgACAAIAAjAFMAZQB0AC0ATABvAGMAYQB0AGkAbwBuACAALQBQAGEAdABoACAAIgAkAGUAbgB2ADoAVQBTAEUAUgBQAFIATwBGAEkATABFAFwATwBuAGUARAByAGkAdgBlACAALQAgAEoAbwBuACAAUwB0AGUAbgBiAGUAcgBnACAAQQBCAFwAMAAyAEQAZQB2AGUAbABvAHAAbQBlAG4AdABcADAAMQBTAG8AdQByAGMAZQBcADAAMgAtAG0AaQBjAHIAbwBzAG8AZgB0AFwAVwBpAG4AZABvAHcAcwAtAEYAdQBuAGMAdABpAG8AbgBzAFwAQwBvAG4AdABlAHgAdAAtAE0AZQBuAHUALQBDAG8AbQBtAGEAbgBkAHMAXABNAHkAVABvAG8AbABzAFwAQgBhAHMAZQBNAGUAbgB1ACIADQAKACAAIAAgACAAIwAkAHQAYQByAGcAZQB0AD0AIgAuAFwATgBlAHcAIABmAG8AbABkAGUAcgAiAA0ACgANAAoADQAKAA0ACgAgACAAIAAgACQAdABhAHIAZwBlAHQAIAA9ACAAJAB0AGEAcgBnAGUAdAAuAFQAcgBpAG0AKAAnAFwAIgAnACkADQAKACAAIAAgACAAJABuAGEAbQBlACAAPQAgAFMAcABsAGkAdAAtAFAAYQB0AGgAIAAkAHQAYQByAGcAZQB0ACAALQBMAGUAYQBmAA0ACgAgACAAIAAgACQAcABhAHIAZQBuAHQAZABpAHIAIAA9ACAAUwBwAGwAaQB0AC0AUABhAHQAaAAgACQAdABhAHIAZwBlAHQAIAAtAFAAYQByAGUAbgB0ACAALQBSAGUAcwBvAGwAdgBlAA0ACgAgACAAIAAgACQAZgB1AGwAbAAgAD0AIABSAGUAcwBvAGwAdgBlAC0AUABhAHQAaAAgACQAdABhAHIAZwBlAHQADQAKAA0ACgAgACAAIAAgACQAbABpAG4AawBOAGEAbQBlACAAPQAgAFsAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGEAdABoAF0AOgA6AEcAZQB0AEYAaQBsAGUATgBhAG0AZQBXAGkAdABoAG8AdQB0AEUAeAB0AGUAbgBzAGkAbwBuACgAJABmAHUAbABsACkAIAArACAAIgBfAGwAaQBuAGsAIgAgACsAIABbAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABhAHQAaABdADoAOgBHAGUAdABFAHgAdABlAG4AcwBpAG8AbgAoACQAZgB1AGwAbAApAA0ACgANAAoAIAAgACAAIAAkAGwAaQBuAGsAUABhAHQAaAAgAD0AIABKAG8AaQBuAC0AUABhAHQAaAAgACQAcABhAHIAZQBuAHQAZABpAHIAIAAkAGwAaQBuAGsATgBhAG0AZQANAAoADQAKACAAIAAgACAAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAgACIAdABhAHIAZwBlAHQAIAAgACAAIAAgAD0AIAAkAHQAYQByAGcAZQB0ACIADQAKACAAIAAgACAAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAgACIAbgBhAG0AZQAgACAAIAAgACAAIAAgAD0AIAAkAG4AYQBtAGUAIgANAAoAIAAgACAAIABXAHIAaQB0AGUALQBPAHUAdABwAHUAdAAgACAAIgBmAHUAbABsACAAcABhAHQAaAAgACAAPQAgACQAZgB1AGwAbAAiAA0ACgAgACAAIAAgAFcAcgBpAHQAZQAtAE8AdQB0AHAAdQB0ACAAIAAiAHAAYQByAGUAbgB0ACAAZABpAHIAIAA9ACAAJABwAGEAcgBlAG4AdABkAGkAcgAiAA0ACgANAAoAIAAgACAAIABXAHIAaQB0AGUALQBPAHUAdABwAHUAdAAgACAAIgBsAGkAbgBrAE4AYQBtAGUAcgAgAD0AIAAkAGwAaQBuAGsATgBhAG0AZQAiAA0ACgAgACAAIAAgAFcAcgBpAHQAZQAtAE8AdQB0AHAAdQB0ACAAIAAiAGwAaQBuAGsAUABhAHQAaAAgAD0AIAAkAGwAaQBuAGsAUABhAHQAaAAiAA0ACgANAAoAIAAgACAAIABOAGUAdwAtAEkAdABlAG0AIAAtAEkAdABlAG0AVAB5AHAAZQAgAFMAeQBtAGIAbwBsAGkAYwBMAGkAbgBrACAALQBQAGEAdABoACAAJABsAGkAbgBrAFAAYQB0AGgAIAAtAFQAYQByAGcAZQB0ACAAJABmAHUAbABsAA0ACgANAAoAIAAgACAAIABTAHQAbwBwAC0AVAByAGEAbgBzAGMAcgBpAHAAdAANAAoADQAKACAAIAAgACAAcABhAHUAcwBlAA0ACgA=          &pause'" & pause
cmd.exe /v /c  powershell -Command "Start-Process cmd -Verb RunAs -ArgumentList '/v /k  echo "%1" | powershell.exe -NoExit  -EncodedCommand <encodedCommand>  &pause'" & pause
,





$input1 | powershell.exe -NoExit -EncodedCommand $command1;
"aa","bb" | powershell.exe -NoExit -Command 'Write-Output(@($input))' 


"aa","bb" | powershell.exe -NoExit -Command '$first = $input | Select-Object -Index 1; Write-Output $first'